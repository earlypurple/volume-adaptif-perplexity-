<!-- pages/demo.html -->
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Démonstration – Volume Adaptatif Pro</title>
  <link rel="stylesheet" href="../style.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div class="app-container">
    <nav class="main-nav">
      <div class="nav-brand"><h1>Volume Adaptatif Pro</h1></div>
      <div class="nav-tabs">
        <button class="nav-tab active">Démonstration</button>
        <button class="nav-tab" onclick="location.href='code.html'">Code Source</button>
        <button class="nav-tab" onclick="location.href='settings.html'">Paramètres</button>
      </div>
    </nav>
    <div class="tab-content active">
      <div class="card">
        <h2>Simulation d'Environnements</h2>
        <select id="envSelect">
          <option value="0">Bureau silencieux</option>
          <option value="1">Bureau ouvert</option>
          <option value="2">Café</option>
          <option value="3">Rue passante</option>
          <option value="4">Construction</option>
        </select>
        <button id="startSim" class="btn btn-secondary">Démarrer la simulation</button>
      </div>
      <div class="card">
        <h2>Graphique Niveau de Bruit & Gain</h2>
        <canvas id="realtimeChart"></canvas>
      </div>
      <div class="card">
        <h2>Performance</h2>
        <canvas id="perfChart"></canvas>
      </div>
    </div>
  </div>
  <script>
    // Extrait de app.js pour démo
    // Simulation de données et mise à jour Chart.js
    const envs = [
      { name: 'Bureau silencieux', base: 35, var: 5 },
      { name: 'Bureau ouvert', base: 45, var: 8 },
      { name: 'Café', base: 55, var: 12 },
      { name: 'Rue passante', base: 65, var: 15 },
      { name: 'Construction', base: 75, var: 20 }
    ];
    let rtChart, pfChart, simInterval;
    document.addEventListener('DOMContentLoaded', () => {
      const ctx = document.getElementById('realtimeChart').getContext('2d');
      rtChart = new Chart(ctx, {
        type: 'line',
         { labels: [], datasets: [
          { label: 'Bruit (dB)', data: [], borderColor: '#3498db' },
          { label: 'Gain Haut-parleur', data: [], borderColor: '#e67e22' }
        ]},
        options: { animation: false, responsive: true }
      });
      const pctx = document.getElementById('perfChart').getContext('2d');
      pfChart = new Chart(pctx, {
        type: 'bar',
         { labels: [], datasets: [
          { label: 'Latence (ms)', data: [], backgroundColor: '#2ecc71' },
          { label: 'CPU (%)', data: [], backgroundColor: '#e74c3c' }
        ]},
        options: { responsive: true }
      });
      document.getElementById('startSim').addEventListener('click', () => {
        clearInterval(simInterval);
        const idx = document.getElementById('envSelect').value;
        const env = envs[idx];
        simInterval = setInterval(() => {
          const noise = env.base + (Math.random()*2-1)*env.var;
          const gain = 1 + 0.04*(noise-env.base);
          const time = new Date().toLocaleTimeString();
          // Mettre à jour realtimeChart
          rtChart.data.labels.push(time);
          rtChart.data.datasets[0].data.push(noise.toFixed(1));
          rtChart.data.datasets[1].data.push(gain.toFixed(2));
          if(rtChart.data.labels.length>20) {
            rtChart.data.labels.shift();
            rtChart.data.datasets.forEach(ds=>ds.data.shift());
          }
          rtChart.update();
          // Mettre à jour perfChart
          pfChart.data.labels.push(time);
          pfChart.data.datasets[0].data.push((Math.random()*50+10).toFixed(0));
          pfChart.data.datasets[1].data.push((Math.random()*30+5).toFixed(0));
          if(pfChart.data.labels.length>20) {
            pfChart.data.labels.shift();
            pfChart.data.datasets.forEach(ds=>ds.data.shift());
          }
          pfChart.update();
        }, 500);
      });
    });
  </script>
</body>
</html>
